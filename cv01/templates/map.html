<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Mapa</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
   crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
   integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
   crossorigin=""></script>
   <script
	  src="https://code.jquery.com/jquery-3.3.1.min.js"
	  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
	  crossorigin="anonymous"></script>
   <link rel="stylesheet" href="/static/markercluster/MarkerCluster.css" />
   <link rel="stylesheet" href="/static/markercluster/MarkerCluster.Default.css" />
   <script src="/static/markercluster/leaflet.markercluster.js"></script>
   <link rel="stylesheet" href="/static/style.css" />
   <script src="/static/map.js"></script>
</head>
<body>
<div id="mapid">
</div>
<div id="controls">
	<input type="checkbox" id="metro_checkbox" name="metro_checkbox" checked>
	<label for="metro_checkbox">Linky metra</label>
	<input type="checkbox" id="vstupy_checkbox" name="vstupy_checkbox" checked>
	<label for="vstupy_checkbox">Vstupy do metra</label>
	<input type="checkbox" id="zast_checkbox" name="zast_checkbox">
	<label for="zast_checkbox">Zastávky</label>
</div>
<div id="search">
	<form method="POST" action="/search">
		<label for="stop_input">Zadej zastávku</label>
		<input type="text" id="stop_input" name="stop_input">
		<input type="submit" value="Vyhledat">
	</form>
</div>

<script>
    var mymap = L.map('mapid');
    mymap.setView([50.08, 14.44], 13);


    var tileLayer = L.tileLayer('https://a.tile.openstreetmap.org/{z}/{x}/{y}.png',
        {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
            maxZoom: 18
        }
    );
    tileLayer.addTo(mymap);

     var linesLG = new L.layerGroup();
     linesLG.addTo(mymap);
     var entriesLG = new L.layerGroup();
     entriesLG.addTo(mymap);
     var stopsLG = new L.layerGroup();
     stopsLG.addTo(mymap);

     var zastCheckbox = document.getElementById("zast_checkbox");
     loadStops(zastCheckbox);
     var entriesCheckbox = document.getElementById("vstupy_checkbox");
     loadEntries(entriesCheckbox);
     var linesCheckbox = document.getElementById("metro_checkbox");
     loadLines(linesCheckbox);

     mymap.on('zoomstart',function(e){stopsLG.clearLayers()});
     mymap.on('zoomend', function(e){loadStops(zastCheckbox)});
     mymap.on('movestart', function(e){stopsLG.clearLayers()});
     mymap.on('moveend', function(e){loadStops(zastCheckbox)});

     zastCheckbox.onchange = zastChanged;
     entriesCheckbox.onchange = entriesChanged;
     linesCheckbox.onchange = linesChanged;

</script>
</body>
</html>
